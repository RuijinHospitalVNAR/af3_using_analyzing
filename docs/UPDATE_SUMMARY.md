# ğŸ“‹ æ›´æ–°æ€»ç»“

## ğŸ‰ ä¸»è¦æ›´æ–°

æ‚¨çš„ AlphaFold3 pLDDT æ‰¹é‡è®¡ç®—è„šæœ¬å·²æˆåŠŸæ›´æ–°ï¼Œç°åœ¨**åŒæ—¶æ”¯æŒ PDB å’Œ CIF æ ¼å¼**ï¼

---

## âœ¨ æ–°åŠŸèƒ½

### 1. CIF æ ¼å¼æ”¯æŒ â­
- âœ… è‡ªåŠ¨è¯†åˆ« `.cif` (mmCIF) æ–‡ä»¶
- âœ… ä½¿ç”¨ `MMCIFParser` è§£æ CIF æ ¼å¼
- âœ… ä¼˜å…ˆä½¿ç”¨ CIF æ ¼å¼ï¼ˆAlphaFold3 é»˜è®¤è¾“å‡ºï¼‰
- âœ… å‘åå…¼å®¹ PDB æ ¼å¼

### 2. æ™ºèƒ½æ–‡ä»¶é€‰æ‹©
- âœ… ä¼˜å…ˆçº§ï¼šCIF > PDB
- âœ… è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ–‡ä»¶
- âœ… å¦‚æœä¸¤ç§æ ¼å¼éƒ½æœ‰ï¼Œä¼˜å…ˆä½¿ç”¨ CIF

### 3. æ”¹è¿›çš„ç”¨æˆ·ä½“éªŒï¼ˆæ”¹è¿›ç‰ˆï¼‰
- âœ… æ˜¾ç¤ºæ–‡ä»¶æ ¼å¼ä¿¡æ¯ `(æ ¼å¼: .cif)`
- âœ… è¯¦ç»†çš„è¿›åº¦æ˜¾ç¤º `[1/100]`
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… æ—¥å¿—ç³»ç»Ÿæ”¯æŒ

---

## ğŸ“ æ›´æ–°çš„æ–‡ä»¶

### è„šæœ¬æ–‡ä»¶

1. **`calc_af3_plddt_batch.py`** (åŸå§‹ç‰ˆ - å·²æ›´æ–°)
   - âœ… æ·»åŠ  CIF æ”¯æŒ
   - âœ… ä¿æŒç®€æ´çš„ä»£ç ç»“æ„
   - âœ… é€‚åˆå¿«é€Ÿæµ‹è¯•

2. **`calc_af3_plddt_batch_improved.py`** (æ”¹è¿›ç‰ˆ - å·²æ›´æ–°)
   - âœ… æ·»åŠ  CIF æ”¯æŒ
   - âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
   - âœ… è¯¦ç»†æ—¥å¿—ç³»ç»Ÿ
   - âœ… æ˜¾ç¤ºæ–‡ä»¶æ ¼å¼ä¿¡æ¯
   - âœ… é€‚åˆç”Ÿäº§ç¯å¢ƒ

### æ–‡æ¡£æ–‡ä»¶ï¼ˆæ–°å»ºï¼‰

3. **`SCRIPT_ANALYSIS.md`** - è¯¦ç»†çš„è„šæœ¬åˆ†ææŠ¥å‘Š
   - ä»£ç è´¨é‡è¯„ä¼°
   - é—®é¢˜åˆ†æ
   - æ”¹è¿›å»ºè®®

4. **`COMPARISON.md`** - ç‰ˆæœ¬å¯¹æ¯”æ–‡æ¡£
   - åŠŸèƒ½å¯¹æ¯”è¡¨
   - æ ¸å¿ƒå·®å¼‚ç¤ºä¾‹
   - ä½¿ç”¨åœºæ™¯æ¨è

5. **`CIF_SUPPORT_GUIDE.md`** - CIF æ”¯æŒæŒ‡å—
   - CIF vs PDB è¯´æ˜
   - æ–‡ä»¶æŸ¥æ‰¾é€»è¾‘
   - æŠ€æœ¯ç»†èŠ‚
   - å¸¸è§é—®é¢˜

6. **`QUICK_START.md`** - å¿«é€Ÿå¼€å§‹æŒ‡å—
   - ä¸€é”®è¿è¡Œå‘½ä»¤
   - å¸¸è§é”™è¯¯è§£å†³
   - ä½¿ç”¨æŠ€å·§

7. **`UPDATE_SUMMARY.md`** - æœ¬æ–‡æ¡£

---

## ğŸ”„ ä»£ç å˜æ›´

### å¯¼å…¥æ¨¡å—
```python
# æ—§ç‰ˆæœ¬
from Bio.PDB import PDBParser

# æ–°ç‰ˆæœ¬
from Bio.PDB import PDBParser, MMCIFParser
```

### æ–‡ä»¶è§£æ
```python
# æ–°å¢ï¼šæ ¹æ®æ–‡ä»¶æ‰©å±•åé€‰æ‹©è§£æå™¨
if structure_file.endswith('.cif'):
    parser = MMCIFParser(QUIET=True)
else:
    parser = PDBParser(QUIET=True)
```

### æ–‡ä»¶æŸ¥æ‰¾
```python
# æ—§ç‰ˆæœ¬ï¼šåªæŸ¥æ‰¾ PDB
pdb_files = [f for f in os.listdir(folder_path) if f.endswith(".pdb")]

# æ–°ç‰ˆæœ¬ï¼šä¼˜å…ˆæŸ¥æ‰¾ CIF
cif_files = [f for f in os.listdir(folder_path) if f.endswith(".cif")]
if cif_files:
    return cif_files[0]  # ä¼˜å…ˆè¿”å› CIF
pdb_files = [f for f in os.listdir(folder_path) if f.endswith(".pdb")]
if pdb_files:
    return pdb_files[0]  # å…¶æ¬¡è¿”å› PDB
```

---

## ğŸ“Š ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ç”¨æ³•ï¼ˆå®Œå…¨å…¼å®¹æ—§å‘½ä»¤ï¼‰

```bash
# âœ… åŸå§‹ç‰ˆæœ¬
python calc_af3_plddt_batch.py \
  --input_dir /mnt/share/chufan/CY_col/rxfp3__results_2/ \
  --output_csv plddt_summary.csv

# âœ… æ”¹è¿›ç‰ˆæœ¬ï¼ˆæ¨èï¼‰
python calc_af3_plddt_batch_improved.py \
  --input_dir /mnt/share/chufan/CY_col/rxfp3__results_2/ \
  --output_csv plddt_summary.csv

# âœ… æ”¹è¿›ç‰ˆæœ¬ + è¯¦ç»†æ—¥å¿—
python calc_af3_plddt_batch_improved.py \
  --input_dir /mnt/share/chufan/CY_col/rxfp3__results_2/ \
  --output_csv plddt_summary.csv \
  --verbose
```

### âš ï¸ ä¿®æ­£å¸¸è§é”™è¯¯

æ‚¨ä¹‹å‰é‡åˆ°çš„é”™è¯¯ï¼š
```bash
# âŒ é”™è¯¯ï¼šé‡å¤è¾“å…¥äº†è·¯å¾„
python calc_af3_plddt_batch_improved.py \
  --input_dir /mnt/share/chufan/CY_col/rxfp3__results_2/ \
  /mnt/share/chufan/CY_col/rxfp3__results_2/
```

æ­£ç¡®çš„å‘½ä»¤ï¼š
```bash
# âœ… æ­£ç¡®ï¼šåªéœ€è¦ä¸€ä¸ªè·¯å¾„
python calc_af3_plddt_batch_improved.py \
  --input_dir /mnt/share/chufan/CY_col/rxfp3__results_2/
```

---

## ğŸ¯ åŠŸèƒ½å¯¹æ¯”

### æ–‡ä»¶æ ¼å¼æ”¯æŒ

|  | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ |
|--|--------|--------|
| PDB (.pdb) | âœ… | âœ… |
| CIF (.cif) | âŒ | âœ… â­ |
| è‡ªåŠ¨è¯†åˆ« | âŒ | âœ… â­ |

### è„šæœ¬ç‰ˆæœ¬å¯¹æ¯”

|  | åŸå§‹ç‰ˆ | æ”¹è¿›ç‰ˆ |
|--|--------|--------|
| CIF æ”¯æŒ | âœ… | âœ… |
| PDB æ”¯æŒ | âœ… | âœ… |
| é”™è¯¯å¤„ç† | âš ï¸ åŸºæœ¬ | âœ… å®Œå–„ |
| è¿›åº¦æ˜¾ç¤º | âš ï¸ ç®€å• | âœ… è¯¦ç»† |
| æ—¥å¿—ç³»ç»Ÿ | âŒ | âœ… |
| æ ¼å¼æç¤º | âŒ | âœ… |
| ä»£ç è¡Œæ•° | ~100 | ~250 |
| é€‚ç”¨åœºæ™¯ | å¿«é€Ÿæµ‹è¯• | ç”Ÿäº§ç¯å¢ƒ |

---

## ğŸ” è¾“å‡ºç¤ºä¾‹å¯¹æ¯”

### åŸå§‹ç‰ˆæœ¬è¾“å‡º
```
ğŸ§­ æ£€æµ‹åˆ° 3 ä¸ªé¢„æµ‹ç»“æœæ–‡ä»¶å¤¹ã€‚æ­£åœ¨åˆ†æ...
âœ… sample_001: 85.23
âœ… sample_002: 78.45
âœ… sample_003: 92.10

ğŸ“Š å·²ç”Ÿæˆç»“æœæ–‡ä»¶: plddt_summary.csv
å…±åˆ†æ 3 ä¸ªæœ‰æ•ˆé¢„æµ‹ç»“æœã€‚
```

### æ”¹è¿›ç‰ˆæœ¬è¾“å‡º
```
ğŸ§­ æ£€æµ‹åˆ° 3 ä¸ªé¢„æµ‹ç»“æœæ–‡ä»¶å¤¹ã€‚æ­£åœ¨åˆ†æ...

[1/3] å¤„ç†: sample_001
  âœ… å¹³å‡ pLDDT: 85.23 (æ ¼å¼: .cif)
[2/3] å¤„ç†: sample_002
  âœ… å¹³å‡ pLDDT: 78.45 (æ ¼å¼: .cif)
[3/3] å¤„ç†: sample_003
  âœ… å¹³å‡ pLDDT: 92.10 (æ ¼å¼: .pdb)

ğŸ“Š å·²ç”Ÿæˆç»“æœæ–‡ä»¶: plddt_summary.csv
âœ… æˆåŠŸåˆ†æ: 3 ä¸ªæ ·æœ¬
âš ï¸  å¤±è´¥/è·³è¿‡: 0 ä¸ªæ ·æœ¬
```

---

## ğŸ“¦ ä¾èµ–è¦æ±‚

```bash
# å¿…éœ€ï¼ˆä¸¤ä¸ªç‰ˆæœ¬éƒ½éœ€è¦ï¼‰
pip install biopython

# éªŒè¯å®‰è£…
python -c "from Bio.PDB import PDBParser, MMCIFParser; print('âœ… OK')"
```

---

## ğŸš€ å»ºè®®ä½¿ç”¨æ–¹å¼

### åœºæ™¯ 1: å¿«é€Ÿæµ‹è¯•ï¼ˆ< 50 ä¸ªæ ·æœ¬ï¼‰
```bash
python calc_af3_plddt_batch.py \
  --input_dir /path/to/results/
```

### åœºæ™¯ 2: ç”Ÿäº§ç¯å¢ƒ / å¤§è§„æ¨¡å¤„ç†
```bash
python calc_af3_plddt_batch_improved.py \
  --input_dir /path/to/results/ \
  --output_csv results.csv
```

### åœºæ™¯ 3: è°ƒè¯•é—®é¢˜
```bash
python calc_af3_plddt_batch_improved.py \
  --input_dir /path/to/results/ \
  --verbose  # æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
```

---

## âœ… å…¼å®¹æ€§è¯´æ˜

### å‘åå…¼å®¹
- âœ… æ‰€æœ‰æ—§çš„ PDB æ–‡ä»¶ä»å¯æ­£å¸¸å¤„ç†
- âœ… å‘½ä»¤è¡Œå‚æ•°å®Œå…¨ç›¸åŒ
- âœ… CSV è¾“å‡ºæ ¼å¼ä¸å˜
- âœ… æ— éœ€ä¿®æ”¹ç°æœ‰è„šæœ¬æˆ–æµç¨‹

### æ–°åŠŸèƒ½
- âœ… CIF æ–‡ä»¶è‡ªåŠ¨è¯†åˆ«å’Œå¤„ç†
- âœ… æ··åˆç›®å½•ï¼ˆåŒæ—¶åŒ…å« PDB å’Œ CIFï¼‰è‡ªåŠ¨å¤„ç†
- âœ… ä¼˜å…ˆä½¿ç”¨ CIF æ ¼å¼ï¼ˆæ›´ç°ä»£ã€æ›´æ ‡å‡†ï¼‰

---

## ğŸ”¬ æŠ€æœ¯ç»†èŠ‚

### pLDDT æå–æ–¹å¼
æ— è®ºä½¿ç”¨ PDB è¿˜æ˜¯ CIF æ ¼å¼ï¼ŒpLDDT æå–æ–¹å¼å®Œå…¨ç›¸åŒï¼š

```python
# B-factor å­—æ®µå­˜å‚¨ pLDDT å€¼
for residue in chain:
    ca_atom = residue["CA"]
    plddt = ca_atom.bfactor  # PDB å’Œ CIF éƒ½ä½¿ç”¨è¿™ä¸ªå­—æ®µ
```

### æ–‡ä»¶é€‰æ‹©ä¼˜å…ˆçº§
```
1. æŸ¥æ‰¾ .cif æ–‡ä»¶
   â”œâ”€ å¦‚æœæ‰¾åˆ° â†’ é€‰æ‹©ç¬¬ä¸€ä¸ª CIF æ–‡ä»¶
   â””â”€ å¦‚æœæ²¡æœ‰ â†’ ç»§ç»­ä¸‹ä¸€æ­¥
   
2. æŸ¥æ‰¾ .pdb æ–‡ä»¶
   â”œâ”€ å¦‚æœæ‰¾åˆ° â†’ é€‰æ‹©ç¬¬ä¸€ä¸ª PDB æ–‡ä»¶
   â””â”€ å¦‚æœæ²¡æœ‰ â†’ è·³è¿‡è¯¥æ ·æœ¬
```

---

## ğŸ“š æ–‡æ¡£ç´¢å¼•

| æ–‡æ¡£ | ç”¨é€” |
|-----|------|
| `QUICK_START.md` | å¿«é€Ÿå¼€å§‹ï¼ŒæŸ¥çœ‹åŸºæœ¬ç”¨æ³• |
| `CIF_SUPPORT_GUIDE.md` | äº†è§£ CIF æ”¯æŒçš„è¯¦ç»†ä¿¡æ¯ |
| `SCRIPT_ANALYSIS.md` | æ·±å…¥äº†è§£ä»£ç è´¨é‡å’Œæ”¹è¿› |
| `COMPARISON.md` | ç‰ˆæœ¬è¯¦ç»†å¯¹æ¯” |
| `UPDATE_SUMMARY.md` | æœ¬æ–‡æ¡£ï¼Œæ›´æ–°æ¦‚è§ˆ |

---

## ğŸ“ å­¦ä¹ å»ºè®®

1. **æ–°æ‰‹ç”¨æˆ·**ï¼š
   - é˜…è¯» `QUICK_START.md`
   - ä½¿ç”¨åŸå§‹ç‰ˆæœ¬å¿«é€Ÿæµ‹è¯•

2. **ç”Ÿäº§ç¯å¢ƒ**ï¼š
   - é˜…è¯» `CIF_SUPPORT_GUIDE.md`
   - ä½¿ç”¨æ”¹è¿›ç‰ˆæœ¬

3. **å¼€å‘è€…**ï¼š
   - é˜…è¯» `SCRIPT_ANALYSIS.md`
   - é˜…è¯» `COMPARISON.md`
   - äº†è§£ä»£ç è®¾è®¡å’Œæœ€ä½³å®è·µ

---

## âœ¨ æ€»ç»“

### ä¸»è¦æ”¹è¿›
1. âœ… **CIF æ ¼å¼æ”¯æŒ** - é€‚é… AlphaFold3 é»˜è®¤è¾“å‡º
2. âœ… **è‡ªåŠ¨æ ¼å¼è¯†åˆ«** - æ— éœ€æ‰‹åŠ¨æŒ‡å®š
3. âœ… **å®Œå…¨å…¼å®¹** - æ—§è„šæœ¬å’Œå‘½ä»¤æ— éœ€ä¿®æ”¹
4. âœ… **æ”¹è¿›ç”¨æˆ·ä½“éªŒ** - æ›´å¥½çš„è¿›åº¦å’Œé”™è¯¯æç¤º

### ç«‹å³ä½¿ç”¨
```bash
# æ¨èå‘½ä»¤
python calc_af3_plddt_batch_improved.py \
  --input_dir /mnt/share/chufan/CY_col/rxfp3__results_2/
```

### éœ€è¦å¸®åŠ©ï¼Ÿ
- æŸ¥çœ‹ `QUICK_START.md` è·å–å¿«é€ŸæŒ‡å—
- æŸ¥çœ‹ `CIF_SUPPORT_GUIDE.md` äº†è§£æŠ€æœ¯ç»†èŠ‚
- ä½¿ç”¨ `--help` æŸ¥çœ‹å‘½ä»¤è¡Œå¸®åŠ©
- ä½¿ç”¨ `--verbose` æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

---

**ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€

---

*æœ€åæ›´æ–°: 2025-10-13*

